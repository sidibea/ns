<?xml version="1.0" encoding="UTF-8" ?>
<!--
	Author: Christian Raue <christian.raue@gmail.com>
	Copyright: 2011-2017 Christian Raue
	License: http://opensource.org/licenses/mit-license.php MIT License
-->
<container xmlns="http://symfony.com/schema/dic/services"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://symfony.com/schema/dic/services http://symfony.com/schema/dic/services/services-1.0.xsd">

	<services>
		<service id="craue.form.flow.storageKeyGenerator" class="Craue\FormFlowBundle\Storage\UserSessionStorageKeyGenerator">
			<argument type="service" id="security.token_storage" />
			<argument type="service" id="session" />
		</service>

		<service id="integrationTestBundle.doctrineConnection" class="Doctrine\DBAL\Connection" public="false">
			<factory class="Doctrine\DBAL\DriverManager" method="getConnection" />
			<argument type="collection">
				<argument key="charset">UTF8</argument>
				<argument key="driver">%db.driver%</argument>
				<argument key="host">%db.host%</argument>
				<argument key="port">%db.port%</argument>
				<argument key="dbname">%db.name%</argument>
				<argument key="user">%db.user%</argument>
				<argument key="password">%db.password%</argument>
				<argument key="path">%db.path%</argument>
			</argument>
		</service>

		<service id="craue.form.flow.storage.doctrine" class="Craue\FormFlowBundle\Storage\DoctrineStorage" public="false">
			<argument type="service" id="integrationTestBundle.doctrineConnection" />
			<argument type="service" id="craue.form.flow.storageKeyGenerator" />
		</service>

		<service id="craue.form.flow.storage" alias="craue.form.flow.storage.doctrine" />
	</services>

</container>
